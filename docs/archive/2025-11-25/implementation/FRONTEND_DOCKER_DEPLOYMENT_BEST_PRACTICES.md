# å‰ç«¯ä»£ç ä¿®æ”¹ä¸Dockeréƒ¨ç½²æœ€ä½³å®è·µ

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0
**æ›´æ–°æ—¶é—´**: 2025-11-25
**é€‚ç”¨åœºæ™¯**: ä¿®æ”¹Open-Notebookï¼ˆè‘£æ™ºï¼‰å‰ç«¯ä»£ç å¹¶éƒ¨ç½²åˆ°Dockerå®¹å™¨

---

## ğŸ“‹ ç›®å½•

1. [ç‰ˆæœ¬å†å²](#ç‰ˆæœ¬å†å²)
2. [å·¥ä½œæµç¨‹æ¦‚è§ˆ](#å·¥ä½œæµç¨‹æ¦‚è§ˆ)
3. [é˜¶æ®µä¸€ï¼šä»£ç ä¿®æ”¹](#é˜¶æ®µä¸€ä»£ç ä¿®æ”¹)
4. [é˜¶æ®µäºŒï¼šéƒ¨ç½²åˆ°Docker](#é˜¶æ®µäºŒéƒ¨ç½²åˆ°docker)
5. [é˜¶æ®µä¸‰ï¼šéªŒè¯å’Œæµ‹è¯•](#é˜¶æ®µä¸‰éªŒè¯å’Œæµ‹è¯•)
6. [æ‰©å±•é•œåƒéƒ¨ç½²](#æ‰©å±•é•œåƒéƒ¨ç½²-v20æ–°å¢)
7. [å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ](#å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ)
8. [æ€§èƒ½ä¼˜åŒ–æŠ€å·§](#æ€§èƒ½ä¼˜åŒ–æŠ€å·§)
9. [ç»éªŒæ•™è®­](#ç»éªŒæ•™è®­)

---

## ç‰ˆæœ¬å†å²

### v2.0 (2025-11-25)
**é‡å¤§æ›´æ–°**ï¼šæ·»åŠ æ‰©å±•é•œåƒéƒ¨ç½²ç­–ç•¥

**æ–°å¢å†…å®¹**ï¼š
- ğŸ†• æ–¹æ¡ˆCï¼šæ‰©å±•é•œåƒï¼ˆç”¨äºéœ€è¦æ–°ä¾èµ–çš„åœºæ™¯ï¼‰
- ğŸ†• æ‰©å±•é•œåƒä¸çƒ­æ›´æ–°çš„é…åˆä½¿ç”¨
- ğŸ†• ä¾èµ–å˜æ›´çš„å†³ç­–æµç¨‹
- ğŸ†• æ‰©å±•é•œåƒéƒ¨ç½²å®Œæ•´æŒ‡å—

**å˜æ›´è¯´æ˜**ï¼š
- v1.0ä¸»è¦é’ˆå¯¹**çº¯ä»£ç ä¿®æ”¹**ï¼ˆå‰ç«¯UIã€æ ·å¼ã€ä¸šåŠ¡é€»è¾‘ï¼‰
- v2.0æ‰©å±•æ”¯æŒ**ä¾èµ–å˜æ›´**ï¼ˆç³»ç»ŸåŒ…ã€PythonåŒ…ã€npmåŒ…ï¼‰
- çƒ­æ›´æ–°æ–¹æ¡ˆ(v1.0)ä»ç„¶é€‚ç”¨ï¼Œæ‰©å±•é•œåƒä½œä¸ºè¡¥å……

**ç›¸å…³æ–‡æ¡£**ï¼š
- [Dockeréƒ¨ç½²ç­–ç•¥æ·±åº¦åˆ†æ](./DOCKER_DEPLOYMENT_STRATEGY_ANALYSIS.md)
- [OCRéƒ¨ç½²æŒ‡å—](./OCR_DEPLOYMENT_GUIDE.md)

### v1.0 (2025-11-23)
**åˆå§‹ç‰ˆæœ¬**ï¼šå‰ç«¯ä»£ç çƒ­æ›´æ–°æœ€ä½³å®è·µ

**è¦†ç›–å†…å®¹**ï¼š
- ä»£ç ä¿®æ”¹å·¥ä½œæµï¼ˆTaskå·¥å…·ã€æ‰‹åŠ¨ç¼–è¾‘ï¼‰
- å®¹å™¨å†…çƒ­æ›´æ–°éƒ¨ç½²æµç¨‹
- éªŒè¯æµ‹è¯•æ¸…å•
- å¸¸è§é—®é¢˜æ’æŸ¥

---

## å·¥ä½œæµç¨‹æ¦‚è§ˆ

### å®Œæ•´æµç¨‹å›¾

```
1. ä»£ç ä¿®æ”¹é˜¶æ®µ (æœ¬åœ°)
   â†“
2. æ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨
   â†“
3. å®¹å™¨å†…æ„å»º
   â†“
4. é‡å¯å®¹å™¨
   â†“
5. éªŒè¯å’Œæµ‹è¯•
```

### æ—¶é—´ä¼°ç®—

| é˜¶æ®µ | é¢„ä¼°æ—¶é—´ | å®é™…æ—¶é—´ï¼ˆæœ¬æ¬¡ä¸­æ–‡åŒ–ï¼‰ |
|------|----------|----------------------|
| ä»£ç ä¿®æ”¹ï¼ˆ17ä¸ªæ–‡ä»¶ï¼‰ | 30-60åˆ†é’Ÿ | 45åˆ†é’Ÿ |
| æ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨ | 1-2åˆ†é’Ÿ | 1åˆ†é’Ÿ |
| å®¹å™¨å†…æ„å»º | 10-20ç§’ | 11ç§’ |
| å®¹å™¨é‡å¯ | 5-10ç§’ | 5ç§’ |
| éªŒè¯æµ‹è¯• | 10-15åˆ†é’Ÿ | N/A |
| **æ€»è®¡** | **50-90åˆ†é’Ÿ** | **çº¦60åˆ†é’Ÿ** |

---

## é˜¶æ®µä¸€ï¼šä»£ç ä¿®æ”¹

### 1.1 ä½¿ç”¨Taskå·¥å…·æ‰¹é‡ä¿®æ”¹ï¼ˆâ­ æ¨èï¼‰

**ä¼˜åŠ¿**ï¼š
- âœ… è‡ªåŠ¨åŒ–å¤„ç†å¤šä¸ªæ–‡ä»¶
- âœ… å‡å°‘äººå·¥é”™è¯¯
- âœ… ä¿æŒä¿®æ”¹ä¸€è‡´æ€§
- âœ… è‡ªåŠ¨ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š

**ä½¿ç”¨åœºæ™¯**ï¼š
- éœ€è¦ä¿®æ”¹5ä¸ªä»¥ä¸Šæ–‡ä»¶
- ä¿®æ”¹æ¶‰åŠé‡å¤æ€§è§„åˆ™ï¼ˆå¦‚ä¸­æ–‡åŒ–ã€é‡å‘½åç­‰ï¼‰
- éœ€è¦ä¿æŒæœ¯è¯­ä¸€è‡´æ€§

**ç¤ºä¾‹å·¥ä½œæµ**ï¼š
1. åˆ›å»ºè¯¦ç»†çš„ä¿®æ”¹è§„åˆ™æ–‡æ¡£
2. åˆ—å‡ºæ‰€æœ‰éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶æ¸…å•
3. è°ƒç”¨Taskå·¥å…·ï¼Œä¼ å…¥è§„åˆ™å’Œæ–‡ä»¶æ¸…å•
4. Taskå·¥å…·è‡ªåŠ¨è¯»å–ã€ä¿®æ”¹ã€ä¿å­˜æ–‡ä»¶
5. è¿”å›è¯¦ç»†ä¿®æ”¹æŠ¥å‘Š

**æœ¬æ¬¡å®è·µ**ï¼š
- ä½¿ç”¨Taskå·¥å…·å¤„ç†17ä¸ªæ–‡ä»¶
- è‡ªåŠ¨åº”ç”¨ä¸­æ–‡åŒ–è§„åˆ™
- ç”Ÿæˆäº†å®Œæ•´çš„ä¿®æ”¹æŠ¥å‘Šï¼ˆ100+å¤„ä¿®æ”¹ï¼‰

---

### 1.2 ä½¿ç”¨Read + Editæ‰‹åŠ¨ä¿®æ”¹

**ä¼˜åŠ¿**ï¼š
- âœ… ç²¾ç¡®æ§åˆ¶æ¯ä¸€å¤„ä¿®æ”¹
- âœ… é€‚åˆå°è§„æ¨¡ä¿®æ”¹
- âœ… å¯ä»¥å³æ—¶éªŒè¯ä¿®æ”¹æ•ˆæœ

**ä½¿ç”¨åœºæ™¯**ï¼š
- ä¿®æ”¹1-4ä¸ªæ–‡ä»¶
- éœ€è¦ç²¾ç¡®æ§åˆ¶ä¿®æ”¹ä½ç½®
- ä¿®æ”¹é€»è¾‘å¤æ‚ï¼Œéš¾ä»¥ç”¨è§„åˆ™æè¿°

**å·¥ä½œæµ**ï¼š
```bash
# 1. è¯»å–æ–‡ä»¶
Read(file_path)

# 2. ä½¿ç”¨Editç²¾ç¡®æ›¿æ¢
Edit(file_path, old_string, new_string)

# 3. éªŒè¯ä¿®æ”¹
Read(file_path) å†æ¬¡æ£€æŸ¥
```

**æ³¨æ„äº‹é¡¹**ï¼š
- âš ï¸ å¿…é¡»å…ˆReadå†Editï¼ˆEditå·¥å…·è¦æ±‚ï¼‰
- âš ï¸ old_stringå¿…é¡»åœ¨æ–‡ä»¶ä¸­å”¯ä¸€ï¼Œå¦åˆ™ä½¿ç”¨replace_allå‚æ•°
- âš ï¸ ä¿æŒåŸæ–‡ä»¶çš„ç¼©è¿›å’Œæ ¼å¼

---

### 1.3 ä¿®æ”¹è§„åˆ™åˆ¶å®šï¼ˆé‡è¦ï¼‰

**åˆ¶å®šæ¸…æ™°çš„è§„åˆ™**ï¼š

```markdown
## ä¸­æ–‡åŒ–è§„åˆ™ï¼ˆç¤ºä¾‹ï¼‰

### ä¿ç•™è‹±æ–‡çš„ä¸“ä¸šæœ¯è¯­
- Embedding, Embedded, Not Embedded
- Speech-to-Text, Text-to-Speech
- Provideråç§°ï¼šOpenai, Ollama, Groqç­‰
- Modelåç§°ï¼šgpt-4, claude-3ç­‰

### éœ€è¦ä¸­æ–‡åŒ–çš„å†…å®¹
- æ‰€æœ‰UIæ–‡æœ¬ã€æŒ‰é’®ã€æ ‡ç­¾
- æè¿°æ€§æ–‡æœ¬ã€æç¤ºä¿¡æ¯
- é”™è¯¯æ¶ˆæ¯ã€æˆåŠŸæ¶ˆæ¯
- å ä½ç¬¦æ–‡æœ¬

### å“ç‰Œåç§°
- "Open Notebook" â†’ "è‘£æ™º"
- "Open Canvas" â†’ ä¿æŒæˆ–è‡ªå®šä¹‰
```

**è§„åˆ™æ–‡æ¡£ä½ç½®å»ºè®®**ï¼š
- `docs/design/LOCALIZATION_RULES.md`
- æˆ–åœ¨å…·ä½“ä»»åŠ¡æ–‡æ¡£ä¸­å®šä¹‰

---

## é˜¶æ®µäºŒï¼šéƒ¨ç½²åˆ°Docker

### 2.1 æ–¹æ¡ˆé€‰æ‹©

#### âŒ æ–¹æ¡ˆAï¼šé‡æ–°æ„å»ºDockeré•œåƒï¼ˆä¸æ¨èï¼‰

**å‘½ä»¤**ï¼š
```bash
docker compose build open_notebook
docker compose up -d open_notebook
```

**é—®é¢˜**ï¼š
- æ„å»ºæ—¶é—´é•¿ï¼ˆ5-15åˆ†é’Ÿï¼‰
- å¯èƒ½é‡åˆ°ç½‘ç»œé—®é¢˜ï¼ˆå¦‚ghcr.ioä¸å¯è®¿é—®ï¼‰
- ä¾èµ–å¤–éƒ¨èµ„æºï¼ˆPythonåŒ…ã€NodeåŒ…ï¼‰
- ä¸é€‚åˆé¢‘ç¹è¿­ä»£

**é€‚ç”¨åœºæ™¯**ï¼š
- ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- Dockerfileæˆ–ä¾èµ–å‘ç”Ÿå˜åŒ–
- éœ€è¦å®Œæ•´çš„ç‰ˆæœ¬æ§åˆ¶

---

#### âœ… æ–¹æ¡ˆBï¼šå®¹å™¨å†…çƒ­æ›´æ–°ï¼ˆâ­ æ¨èç”¨äºå¼€å‘ï¼‰

**å·¥ä½œæµ**ï¼š
```bash
# 1. å¤åˆ¶æ–‡ä»¶åˆ°å®¹å™¨
docker cp æœ¬åœ°æ–‡ä»¶è·¯å¾„ å®¹å™¨å:/å®¹å™¨å†…è·¯å¾„

# 2. å®¹å™¨å†…æ„å»º
docker exec å®¹å™¨å sh -c "cd /app/frontend && npm run build"

# 3. é‡å¯å®¹å™¨
docker compose restart å®¹å™¨å
```

**ä¼˜åŠ¿**ï¼š
- âš¡ é€Ÿåº¦å¿«ï¼ˆæ€»æ—¶é—´ < 1åˆ†é’Ÿï¼‰
- âœ… ä¸ä¾èµ–å¤–éƒ¨ç½‘ç»œ
- âœ… åˆ©ç”¨Next.jså¢é‡æ„å»º
- âœ… é€‚åˆå¿«é€Ÿè¿­ä»£

**é€‚ç”¨åœºæ™¯**ï¼š
- å¼€å‘ç¯å¢ƒè°ƒè¯•
- å‰ç«¯ä»£ç ä¿®æ”¹
- æ ·å¼å’Œæ–‡æœ¬è°ƒæ•´

---

### 2.2 æ‰¹é‡å¤åˆ¶æ–‡ä»¶æœ€ä½³å®è·µ

#### æ–¹æ³•1ï¼šé€ä¸ªå¤åˆ¶ï¼ˆæ¨èç”¨äºå°‘é‡æ–‡ä»¶ï¼‰

```bash
docker cp /path/to/file1.tsx container:/app/frontend/src/components/
docker cp /path/to/file2.tsx container:/app/frontend/src/components/
```

**ä¼˜åŠ¿**ï¼šæ¸…æ™°ã€å¯æ§ã€æ˜“äºè°ƒè¯•

---

#### æ–¹æ³•2ï¼šé“¾å¼å¤åˆ¶ï¼ˆæ¨èç”¨äºå¤šä¸ªæ–‡ä»¶ï¼‰

```bash
docker cp file1.tsx container:/path1/ && \
docker cp file2.tsx container:/path2/ && \
docker cp file3.tsx container:/path3/
```

**ä¼˜åŠ¿**ï¼šå‡å°‘å‘½ä»¤è°ƒç”¨æ¬¡æ•°

---

#### æ–¹æ³•3ï¼šåˆ›å»ºä¸´æ—¶ç›®å½•æ‰¹é‡å¤åˆ¶ï¼ˆå¤æ‚åœºæ™¯ï¼‰

```bash
# 1. åˆ›å»ºä¸´æ—¶ç›®å½•
mkdir -p /tmp/frontend_update
cp -r modified_files/* /tmp/frontend_update/

# 2. æ•´ä½“å¤åˆ¶
docker cp /tmp/frontend_update/. container:/app/frontend/src/

# 3. æ¸…ç†
rm -rf /tmp/frontend_update
```

**ä¼˜åŠ¿**ï¼šé€‚åˆå¤§é‡æ–‡ä»¶ï¼ˆ20+ï¼‰

---

### 2.3 å®¹å™¨å†…æ„å»º

#### åŸºæœ¬æ„å»ºå‘½ä»¤

```bash
docker exec chairman_open_notebook sh -c "cd /app/frontend && npm run build"
```

#### æŸ¥çœ‹æ„å»ºè¾“å‡ºï¼ˆæ¨èï¼‰

```bash
# æŸ¥çœ‹æœ€å50è¡Œè¾“å‡º
docker exec chairman_open_notebook sh -c "cd /app/frontend && npm run build 2>&1 | tail -50"
```

#### è®¾ç½®è¶…æ—¶æ—¶é—´

```bash
# Bashå·¥å…·è®¾ç½®timeoutå‚æ•°
Bash(command="...", timeout=300000)  # 5åˆ†é’Ÿ
```

#### éªŒè¯æ„å»ºæˆåŠŸ

**æˆåŠŸæ ‡å¿—**ï¼š
- âœ… "Compiled successfully in X.Xs"
- âœ… æ‰€æœ‰è·¯ç”±æ­£ç¡®ç”Ÿæˆ
- âœ… æ— è‡´å‘½é”™è¯¯ï¼ˆERRORï¼‰

**å¯æ¥å—çš„è­¦å‘Š**ï¼š
- âš ï¸ ESLintè­¦å‘Šï¼ˆno-unused-varsç­‰ï¼‰
- âš ï¸ Next.jsæ€§èƒ½å»ºè®®ï¼ˆä½¿ç”¨Imageç»„ä»¶ç­‰ï¼‰

---

### 2.4 é‡å¯å®¹å™¨

```bash
# æ–¹å¼1ï¼šä½¿ç”¨docker composeï¼ˆæ¨èï¼‰
docker compose restart open_notebook

# æ–¹å¼2ï¼šç›´æ¥é‡å¯å®¹å™¨
docker restart chairman_open_notebook

# éªŒè¯å®¹å™¨çŠ¶æ€
docker compose ps open_notebook
```

**å¥åº·æ£€æŸ¥**ï¼š
```
STATUS: Up X seconds (healthy)
```

---

## é˜¶æ®µä¸‰ï¼šéªŒè¯å’Œæµ‹è¯•

### 3.1 å¿«é€ŸéªŒè¯æ¸…å•

#### åŸºç¡€éªŒè¯
- [ ] å®¹å™¨çŠ¶æ€ä¸º `healthy`
- [ ] Web UIå¯è®¿é—®ï¼ˆhttp://localhost:8502ï¼‰
- [ ] ç™»å½•é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] å¯¼èˆªèœå•æ­£å¸¸å·¥ä½œ

#### åŠŸèƒ½éªŒè¯ï¼ˆæ ¹æ®ä¿®æ”¹å†…å®¹ï¼‰
- [ ] ä¿®æ”¹çš„é¡µé¢æ­£ç¡®æ˜¾ç¤º
- [ ] ä¸­æ–‡æ–‡æœ¬æ— ä¹±ç 
- [ ] ä¸“ä¸šæœ¯è¯­ä¿æŒè‹±æ–‡ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] æŒ‰é’®å’Œäº¤äº’æ­£å¸¸

#### æµè§ˆå™¨æµ‹è¯•
- [ ] Chrome/Edgeæµ‹è¯•
- [ ] Safariæµ‹è¯•ï¼ˆMacï¼‰
- [ ] ç§»åŠ¨ç«¯å“åº”å¼æµ‹è¯•

---

### 3.2 å¸¸è§æµ‹è¯•åœºæ™¯

#### ä¸­æ–‡åŒ–éªŒè¯
```
æµ‹è¯•ç‚¹ï¼š
1. æ‰€æœ‰UIæ–‡æœ¬æ˜¯å¦æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡
2. ä¸“ä¸šæœ¯è¯­æ˜¯å¦ä¿æŒè‹±æ–‡
3. ä¸­è‹±æ–‡æ··æ’æ˜¯å¦è‡ªç„¶
4. å­—ä½“æ¸²æŸ“æ˜¯å¦æ¸…æ™°
```

#### åŠŸèƒ½å›å½’æµ‹è¯•
```
æµ‹è¯•ç‚¹ï¼š
1. åˆ›å»º/ç¼–è¾‘/åˆ é™¤æ“ä½œæ­£å¸¸
2. è¡¨å•éªŒè¯æ­£ç¡®
3. é”™è¯¯æç¤ºæ­£ç¡®æ˜¾ç¤º
4. æˆåŠŸæç¤ºæ­£ç¡®æ˜¾ç¤º
```

---

## æ‰©å±•é•œåƒéƒ¨ç½² (v2.0æ–°å¢)

### 6.1 é€‚ç”¨åœºæ™¯

**æ‰©å±•é•œåƒ**ï¼ˆSolution Cï¼‰é€‚ç”¨äºéœ€è¦æ·»åŠ **ç³»ç»Ÿçº§ä¾èµ–æˆ–PythonåŒ…**çš„åœºæ™¯ã€‚

#### ä½•æ—¶ä½¿ç”¨æ‰©å±•é•œåƒï¼Ÿ

âœ… **å¿…é¡»ä½¿ç”¨æ‰©å±•é•œåƒçš„æƒ…å†µ**ï¼š
- éœ€è¦å®‰è£…aptç³»ç»ŸåŒ…ï¼ˆå¦‚OpenCVåº“ã€ç³»ç»Ÿå·¥å…·ï¼‰
- éœ€è¦æ·»åŠ æ–°çš„PythonåŒ…ï¼ˆå¦‚PaddleOCRã€PyMuPDFï¼‰
- éœ€è¦ä¿®æ”¹åŸºç¡€ç¯å¢ƒé…ç½®

âŒ **ä¸éœ€è¦æ‰©å±•é•œåƒçš„æƒ…å†µ**ï¼ˆä½¿ç”¨çƒ­æ›´æ–°å³å¯ï¼‰ï¼š
- çº¯å‰ç«¯ä»£ç ä¿®æ”¹ï¼ˆUIã€æ ·å¼ã€ç»„ä»¶ï¼‰
- çº¯Pythonä¸šåŠ¡é€»è¾‘ä¿®æ”¹ï¼ˆä¸å¢åŠ ä¾èµ–ï¼‰
- é…ç½®æ–‡ä»¶ä¿®æ”¹

#### å†³ç­–æµç¨‹å›¾

```
ä¿®æ”¹å†…å®¹
  â”œâ”€ æ˜¯å¦éœ€è¦æ–°çš„aptåŒ…ï¼Ÿ
  â”‚    â”œâ”€ æ˜¯ â†’ ä½¿ç”¨æ‰©å±•é•œåƒï¼ˆSolution Cï¼‰
  â”‚    â””â”€ å¦ â†’ ç»§ç»­åˆ¤æ–­
  â”‚
  â”œâ”€ æ˜¯å¦éœ€è¦æ–°çš„PythonåŒ…ï¼Ÿ
  â”‚    â”œâ”€ æ˜¯ â†’ ä½¿ç”¨æ‰©å±•é•œåƒï¼ˆSolution Cï¼‰
  â”‚    â””â”€ å¦ â†’ ç»§ç»­åˆ¤æ–­
  â”‚
  â””â”€ ä»…ä»£ç æˆ–é…ç½®ä¿®æ”¹ï¼Ÿ
       â””â”€ æ˜¯ â†’ ä½¿ç”¨çƒ­æ›´æ–°ï¼ˆSolution Bï¼Œå‚è§v1.0æ–¹æ¡ˆï¼‰
```

---

### 6.2 æ‰©å±•é•œåƒå·¥ä½œæµ

#### é˜¶æ®µ1ï¼šåˆ›å»ºDockerfile.ocr

åœ¨ `thirdparty/open-notebook/` ç›®å½•ä¸‹åˆ›å»ºæ‰©å±•Dockerfileï¼š

```dockerfile
# Dockerfile.ocr
# åŸºäºå®˜æ–¹é•œåƒæ‰©å±•ï¼Œæ·»åŠ OCRåŠŸèƒ½

# ARGå…è®¸é€šè¿‡docker-compose.ymlæŒ‡å®šåŸºç¡€ç‰ˆæœ¬
ARG BASE_VERSION=v1-latest-single

FROM lfnovo/open_notebook:${BASE_VERSION}

# åˆ‡æ¢åˆ°rootå®‰è£…ç³»ç»ŸåŒ…
USER root

# å®‰è£…OCRæ‰€éœ€çš„ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    libgl1-mesa-glx \
    libglib2.0-0 \
    libsm6 \
    libxrender1 \
    libxext6 \
    && rm -rf /var/lib/apt/lists/*

# å®‰è£…Python OCRåŒ…
RUN /app/.venv/bin/pip install --no-cache-dir \
    PyMuPDF>=1.24.0 \
    paddlepaddle>=2.6.0 \
    paddleocr>=2.8.0 \
    Pillow>=10.0.0

# å¤åˆ¶OCRä»£ç æ–‡ä»¶
COPY open_notebook/utils/pdf_ocr_utils.py /app/open_notebook/utils/
COPY open_notebook/graphs/source.py /app/open_notebook/graphs/

# æ¢å¤åˆ°érootç”¨æˆ·
USER 1000

# ç»§æ‰¿å®˜æ–¹é•œåƒçš„å¯åŠ¨å‘½ä»¤
CMD ["/usr/bin/supervisord", "-c", "/etc/supervisor/conf.d/supervisord.conf"]
```

**å…³é”®è¯´æ˜**ï¼š
- `ARG BASE_VERSION`ï¼šæ”¯æŒç‰ˆæœ¬å‚æ•°åŒ–
- `FROM lfnovo/open_notebook:${BASE_VERSION}`ï¼šåŸºäºå®˜æ–¹é•œåƒ
- ç»§æ‰¿å®˜æ–¹é•œåƒçš„å…¨éƒ¨é…ç½®å’Œä»£ç 
- ä»…æ·»åŠ å¢é‡ä¾èµ–å’Œä»£ç 

---

#### é˜¶æ®µ2ï¼šä¿®æ”¹docker-compose.yml

```yaml
services:
  open_notebook:
    # ä»ä½¿ç”¨å®˜æ–¹é•œåƒåˆ‡æ¢ä¸ºæ„å»ºæ‰©å±•é•œåƒ
    build:
      context: ./thirdparty/open-notebook
      dockerfile: Dockerfile.ocr
      args:
        BASE_VERSION: v1-latest-single  # å¯çµæ´»æŒ‡å®šç‰ˆæœ¬
    image: chairman_open_notebook:ocr-v1.0.0
    container_name: chairman_open_notebook

    # å…¶ä»–é…ç½®ä¿æŒä¸å˜...
    environment:
      - PYTHONUNBUFFERED=1
    ports:
      - "8502:8501"
    volumes:
      - open_notebook_data:/app/data
    networks:
      - chairman-network
```

**å˜æ›´è¯´æ˜**ï¼š
- ä» `image: lfnovo/open_notebook:v1-latest-single`
- æ”¹ä¸º `build: ... + image: chairman_open_notebook:ocr-v1.0.0`
- å…¶ä»–é…ç½®å®Œå…¨ä¿æŒä¸å˜

---

#### é˜¶æ®µ3ï¼šæ„å»ºæ‰©å±•é•œåƒ

```bash
# 1. æ„å»ºé•œåƒ
docker compose build open_notebook

# 2. æŸ¥çœ‹æ„å»ºè¾“å‡º
# é¢„æœŸçœ‹åˆ°ï¼š
# - [+] Building 120.5s (15/15) FINISHED
# - => [stage-0 3/8] RUN apt-get update && apt-get install...
# - => [stage-0 4/8] RUN /app/.venv/bin/pip install...

# 3. éªŒè¯é•œåƒå·²åˆ›å»º
docker images | grep chairman_open_notebook

# åº”è¯¥çœ‹åˆ°ï¼š
# chairman_open_notebook   ocr-v1.0.0   abc123def456   2 minutes ago   2.5GB
```

---

#### é˜¶æ®µ4ï¼šå¯åŠ¨å¹¶éªŒè¯

```bash
# 1. å¯åŠ¨å®¹å™¨
docker compose up -d open_notebook

# 2. æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker compose ps open_notebook

# åº”è¯¥çœ‹åˆ°ï¼š
# NAME                      STATUS        PORTS
# chairman_open_notebook    Up (healthy)  0.0.0.0:8502->8501/tcp

# 3. éªŒè¯ä¾èµ–æ˜¯å¦å®‰è£…æˆåŠŸ
docker exec chairman_open_notebook sh -c "/app/.venv/bin/pip list | grep -E '(paddleocr|PyMuPDF|Pillow)'"

# åº”è¯¥çœ‹åˆ°ï¼š
# paddleocr        2.8.1
# paddlepaddle     2.6.2
# Pillow           10.4.0
# PyMuPDF          1.24.12

# 4. éªŒè¯OCRä»£ç æ–‡ä»¶
docker exec chairman_open_notebook ls -la /app/open_notebook/utils/ | grep pdf_ocr

# 5. è®¿é—®Web UIæµ‹è¯•åŠŸèƒ½
# http://localhost:8502
```

---

### 6.3 æ‰©å±•é•œåƒ + çƒ­æ›´æ–°é…åˆä½¿ç”¨

**é‡è¦æ¦‚å¿µ**ï¼šæ‰©å±•é•œåƒå’Œçƒ­æ›´æ–°**ä¸æ˜¯äº’æ–¥çš„**ï¼Œè€Œæ˜¯**åˆ†å±‚ç»„åˆ**ã€‚

#### æ¶æ„ç†è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¼€å‘è¿­ä»£å±‚ï¼ˆ99%çš„å·¥ä½œï¼‰         â”‚ â† ä½¿ç”¨çƒ­æ›´æ–°ï¼ˆSolution Bï¼‰
â”‚   - å‰ç«¯UIä¿®æ”¹                   â”‚
â”‚   - Pythonä¸šåŠ¡é€»è¾‘ä¿®æ”¹            â”‚
â”‚   - é…ç½®æ–‡ä»¶è°ƒæ•´                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åŸºç¡€è®¾æ–½å±‚ï¼ˆ1%çš„å·¥ä½œï¼‰          â”‚ â† ä½¿ç”¨æ‰©å±•é•œåƒï¼ˆSolution Cï¼‰
â”‚   - ç³»ç»Ÿä¾èµ–ï¼ˆaptåŒ…ï¼‰             â”‚
â”‚   - Pythonä¾èµ–ï¼ˆpipåŒ…ï¼‰           â”‚
â”‚   - ç¯å¢ƒé…ç½®                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®˜æ–¹é•œåƒå±‚                      â”‚ â† å®˜æ–¹ç»´æŠ¤
â”‚   - åŸºç¡€æ¡†æ¶ä»£ç                   â”‚
â”‚   - æ ¸å¿ƒä¾èµ–                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å®é™…å·¥ä½œæµç¤ºä¾‹

**åœºæ™¯1ï¼šæ·»åŠ æ–°åŠŸèƒ½ï¼ˆæœ‰æ–°ä¾èµ–ï¼‰**

```bash
# ç¬¬1æ­¥ï¼šä¿®æ”¹Dockerfile.ocrï¼Œæ·»åŠ æ–°ä¾èµ–
# ç¼–è¾‘ thirdparty/open-notebook/Dockerfile.ocr
# æ·»åŠ ï¼šRUN pip install new-package

# ç¬¬2æ­¥ï¼šé‡æ–°æ„å»ºæ‰©å±•é•œåƒï¼ˆä»…æ­¤ä¸€æ¬¡ï¼‰
docker compose build open_notebook
docker compose up -d open_notebook

# ç¬¬3æ­¥ï¼šåç»­ä»£ç ä¿®æ”¹ä½¿ç”¨çƒ­æ›´æ–°
docker cp modified_code.py chairman_open_notebook:/app/
docker compose restart open_notebook
```

**åœºæ™¯2ï¼šä¿®æ”¹ç°æœ‰åŠŸèƒ½ï¼ˆæ— æ–°ä¾èµ–ï¼‰**

```bash
# ç›´æ¥ä½¿ç”¨çƒ­æ›´æ–°ï¼Œæ— éœ€é‡å»ºé•œåƒ
docker cp updated_file.py chairman_open_notebook:/app/path/
docker exec chairman_open_notebook sh -c "cd /app/frontend && npm run build"
docker compose restart open_notebook
```

---

### 6.4 ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

#### ç­–ç•¥Aï¼šå›ºå®šç‰ˆæœ¬ï¼ˆæ¨èç”¨äºç”Ÿäº§ï¼‰

```yaml
# docker-compose.yml
build:
  args:
    BASE_VERSION: v1.2.3  # å›ºå®šå®˜æ–¹ç‰ˆæœ¬å·
image: chairman_open_notebook:ocr-v1.0.0
```

**ä¼˜åŠ¿**ï¼š
- âœ… å¯é‡ç°æ„å»º
- âœ… ç‰ˆæœ¬æ˜ç¡®å¯è¿½æº¯
- âœ… é€‚åˆç”Ÿäº§ç¯å¢ƒ

**åŒæ­¥å®˜æ–¹æ›´æ–°**ï¼š
```bash
# å½“å®˜æ–¹å‘å¸ƒv1.2.4æ—¶
# 1. ä¿®æ”¹docker-compose.ymlä¸­çš„BASE_VERSION
# 2. é‡æ–°æ„å»º
docker compose build open_notebook
# 3. æµ‹è¯•éªŒè¯
# 4. éƒ¨ç½²
docker compose up -d open_notebook
```

---

#### ç­–ç•¥Bï¼šè·Ÿéšæœ€æ–°ç‰ˆï¼ˆé€‚åˆå¼€å‘ï¼‰

```yaml
# docker-compose.yml
build:
  args:
    BASE_VERSION: v1-latest-single  # å§‹ç»ˆè·Ÿéšæœ€æ–°
image: chairman_open_notebook:ocr-latest
```

**ä¼˜åŠ¿**ï¼š
- âœ… è‡ªåŠ¨è·å–å®˜æ–¹æœ€æ–°ç‰¹æ€§
- âœ… å‡å°‘æ‰‹åŠ¨æ›´æ–°

**é£é™©**ï¼š
- âš ï¸ å®˜æ–¹æ›´æ–°å¯èƒ½å¼•å…¥ä¸å…¼å®¹å˜æ›´

---

#### ç­–ç•¥Cï¼šæ··åˆç­–ç•¥

```yaml
# å¼€å‘ç¯å¢ƒ
BASE_VERSION: v1-latest-single

# æµ‹è¯•ç¯å¢ƒ
BASE_VERSION: v1.2.4-rc1

# ç”Ÿäº§ç¯å¢ƒ
BASE_VERSION: v1.2.3
```

---

### 6.5 åˆ‡æ¢å›å®˜æ–¹é•œåƒ

å¦‚æœéœ€è¦ä¸´æ—¶åˆ‡æ¢å›å®˜æ–¹é•œåƒï¼ˆå¦‚å¯¹æ¯”æµ‹è¯•ï¼‰ï¼š

```yaml
# docker-compose.yml
services:
  open_notebook:
    # æ–¹å¼1ï¼šæ³¨é‡Šæ‰buildï¼Œå¯ç”¨image
    # build:
    #   context: ./thirdparty/open-notebook
    #   dockerfile: Dockerfile.ocr
    image: lfnovo/open_notebook:v1-latest-single

    # å…¶ä»–é…ç½®ä¸å˜...
```

```bash
# é‡æ–°éƒ¨ç½²
docker compose down open_notebook
docker compose up -d open_notebook
```

**æ³¨æ„**ï¼šåˆ‡æ¢å›å®˜æ–¹é•œåƒåï¼Œæ‰©å±•çš„ä¾èµ–ï¼ˆå¦‚OCRåŒ…ï¼‰å°†ä¸å¯ç”¨ã€‚

---

### 6.6 å¤šç‰ˆæœ¬å…±å­˜

å¯ä»¥åŒæ—¶è¿è¡Œå®˜æ–¹é•œåƒå’Œæ‰©å±•é•œåƒè¿›è¡Œå¯¹æ¯”æµ‹è¯•ï¼š

```yaml
# docker-compose.yml
services:
  # å®˜æ–¹ç‰ˆæœ¬ï¼ˆç«¯å£8502ï¼‰
  open_notebook_official:
    image: lfnovo/open_notebook:v1-latest-single
    container_name: chairman_open_notebook_official
    ports:
      - "8502:8501"

  # æ‰©å±•ç‰ˆæœ¬ï¼ˆç«¯å£8503ï¼‰
  open_notebook_ocr:
    build:
      context: ./thirdparty/open-notebook
      dockerfile: Dockerfile.ocr
    image: chairman_open_notebook:ocr-v1.0.0
    container_name: chairman_open_notebook_ocr
    ports:
      - "8503:8501"
```

---

### 6.7 æ‰©å±•é•œåƒæœ€ä½³å®è·µ

#### âœ… æ¨èåšæ³•

1. **æœ€å°åŒ–æ”¹åŠ¨**
   - åªæ·»åŠ å¿…éœ€çš„ä¾èµ–
   - ä¸ä¿®æ”¹å®˜æ–¹é•œåƒçš„ä»£ç å’Œé…ç½®

2. **ç‰ˆæœ¬æ ‡è®°æ¸…æ™°**
   ```yaml
   image: chairman_open_notebook:ocr-v1.0.0
   # å‘½åæ ¼å¼ï¼š<é¡¹ç›®å>_<æœåŠ¡å>:<æ‰©å±•ç±»å‹>-<ç‰ˆæœ¬å·>
   ```

3. **åˆ†å±‚æ„å»º**
   ```dockerfile
   # åŸºç¡€æ‰©å±•å±‚ï¼ˆç³»ç»Ÿä¾èµ–ï¼‰
   RUN apt-get install ...

   # Pythonä¾èµ–å±‚
   RUN pip install ...

   # ä»£ç å¤åˆ¶å±‚
   COPY ...
   ```

4. **åˆ©ç”¨æ„å»ºç¼“å­˜**
   - å…ˆå®‰è£…ä¾èµ–ï¼ˆå˜åŒ–å°‘ï¼‰
   - åå¤åˆ¶ä»£ç ï¼ˆå˜åŒ–å¤šï¼‰

5. **è®°å½•æ‰©å±•å†…å®¹**
   - åœ¨Dockerfileä¸­æ·»åŠ æ³¨é‡Š
   - ç»´æŠ¤CHANGELOGè®°å½•æ‰©å±•å†å²

#### âŒ é¿å…çš„é”™è¯¯

1. **ä¸è¦ä¿®æ”¹å®˜æ–¹é•œåƒçš„åŸå§‹æ–‡ä»¶**
   - åªæ·»åŠ æ–°æ–‡ä»¶
   - éœ€è¦ä¿®æ”¹æ—¶ä¼˜å…ˆä½¿ç”¨é…ç½®è¦†ç›–

2. **ä¸è¦åœ¨Dockerfileä¸­ç¡¬ç¼–ç è·¯å¾„**
   ```dockerfile
   # é”™è¯¯
   COPY /Users/xxx/project/file.py /app/

   # æ­£ç¡®
   COPY open_notebook/utils/file.py /app/open_notebook/utils/
   ```

3. **ä¸è¦å¿½ç•¥æ„å»ºç¼“å­˜ä¼˜åŒ–**
   ```dockerfile
   # ä½æ•ˆï¼šæ¯æ¬¡ä¿®æ”¹ä»£ç éƒ½é‡æ–°å®‰è£…ä¾èµ–
   COPY . /app/
   RUN pip install -r requirements.txt

   # é«˜æ•ˆï¼šä¾èµ–å±‚å’Œä»£ç å±‚åˆ†ç¦»
   COPY requirements.txt /app/
   RUN pip install -r requirements.txt
   COPY . /app/
   ```

---

### 6.8 å®Œæ•´å‘½ä»¤å‚è€ƒ

```bash
# ========== æ‰©å±•é•œåƒå·¥ä½œæµ ==========

# 1. åˆ›å»ºDockerfile.ocrï¼ˆä¸€æ¬¡æ€§ï¼‰
vim thirdparty/open-notebook/Dockerfile.ocr

# 2. ä¿®æ”¹docker-compose.ymlï¼ˆä¸€æ¬¡æ€§ï¼‰
vim docker-compose.yml

# 3. æ„å»ºæ‰©å±•é•œåƒ
docker compose build open_notebook

# 4. å¯åŠ¨å®¹å™¨
docker compose up -d open_notebook

# 5. éªŒè¯æ‰©å±•å†…å®¹
docker exec chairman_open_notebook sh -c "/app/.venv/bin/pip list | grep paddleocr"
docker exec chairman_open_notebook ls -la /app/open_notebook/utils/

# 6. æŸ¥çœ‹é•œåƒä¿¡æ¯
docker images | grep chairman_open_notebook
docker inspect chairman_open_notebook:ocr-v1.0.0

# ========== æ—¥å¸¸å¼€å‘ï¼ˆä½¿ç”¨çƒ­æ›´æ–°ï¼‰ ==========

# 7. ä»£ç ä¿®æ”¹åå¤åˆ¶åˆ°å®¹å™¨
docker cp modified_file.py chairman_open_notebook:/app/path/

# 8. é‡å¯å®¹å™¨
docker compose restart open_notebook

# ========== ç‰ˆæœ¬ç®¡ç† ==========

# 9. æŸ¥çœ‹å®˜æ–¹é•œåƒç‰ˆæœ¬
docker images | grep lfnovo/open_notebook

# 10. æ›´æ–°åŸºç¡€ç‰ˆæœ¬
# ç¼–è¾‘docker-compose.ymlä¸­çš„BASE_VERSION
# ç„¶åé‡æ–°æ„å»º
docker compose build open_notebook

# 11. æ¸…ç†æ—§é•œåƒ
docker images | grep chairman_open_notebook
docker rmi <image_id>

# ========== æ•…éšœæ’æŸ¥ ==========

# 12. æŸ¥çœ‹æ„å»ºæ—¥å¿—
docker compose build open_notebook 2>&1 | tee build.log

# 13. è¿›å…¥å®¹å™¨è°ƒè¯•
docker exec -it chairman_open_notebook sh

# 14. æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker compose logs -f open_notebook
```

---

### 6.9 æ‰©å±•é•œåƒä¸çƒ­æ›´æ–°å¯¹æ¯”æ€»ç»“

| ç»´åº¦ | æ‰©å±•é•œåƒï¼ˆSolution Cï¼‰ | çƒ­æ›´æ–°ï¼ˆSolution Bï¼‰ |
|-----|---------------------|-------------------|
| **ä½¿ç”¨é¢‘ç‡** | 1%ï¼ˆåŸºç¡€è®¾æ–½å˜æ›´ï¼‰ | 99%ï¼ˆæ—¥å¸¸å¼€å‘ï¼‰ |
| **é€‚ç”¨åœºæ™¯** | ç³»ç»ŸåŒ…ã€PythonåŒ…ã€ç¯å¢ƒé…ç½® | ä»£ç ä¿®æ”¹ã€é…ç½®æ–‡ä»¶ |
| **æ„å»ºæ—¶é—´** | 5-10åˆ†é’Ÿï¼ˆé¦–æ¬¡ï¼‰ | <1åˆ†é’Ÿ |
| **é‡å¯éœ€æ±‚** | éœ€è¦ | éœ€è¦ |
| **æŒä¹…æ€§** | æ°¸ä¹…ï¼ˆé•œåƒå±‚ï¼‰ | ä¸´æ—¶ï¼ˆå®¹å™¨å±‚ï¼‰ |
| **ç‰ˆæœ¬æ§åˆ¶** | Dockerfile + Git | ä»£ç æ–‡ä»¶ + Git |
| **é€‚åˆç¯å¢ƒ** | å¼€å‘+ç”Ÿäº§ | å¼€å‘ç¯å¢ƒ |
| **å­¦ä¹ æ›²çº¿** | ä¸­ç­‰ | ç®€å• |

**æ ¸å¿ƒåŸåˆ™**ï¼š
- ğŸ—ï¸ **åŸºç¡€è®¾æ–½å˜æ›´** â†’ æ‰©å±•é•œåƒ
- ğŸ’» **ä»£ç ä¸šåŠ¡å˜æ›´** â†’ çƒ­æ›´æ–°
- ğŸ”„ **ä¸¤è€…é…åˆä½¿ç”¨** â†’ æœ€ä½³å®è·µ

---

## å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜1ï¼šDockeræ„å»ºå¤±è´¥ï¼ˆghcr.ioç½‘ç»œé—®é¢˜ï¼‰

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Service Unavailable: Get "https://ghcr.io/v2/astral-sh/uv/blobs/..."
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
âœ… **æ”¹ç”¨å®¹å™¨å†…çƒ­æ›´æ–°**ï¼Œä¸é‡æ–°æ„å»ºé•œåƒ

**æ›¿ä»£æ–¹æ¡ˆ**ï¼ˆå¦‚å¿…é¡»é‡å»ºï¼‰ï¼š
- é…ç½®Dockeré•œåƒä»£ç†
- ä½¿ç”¨VPNæˆ–ä»£ç†æœåŠ¡
- åˆ‡æ¢åˆ°å›½å†…é•œåƒæº

---

### é—®é¢˜2ï¼šæ–‡ä»¶å¤åˆ¶è·¯å¾„é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
No such file or directory
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥å®¹å™¨å†…è·¯å¾„æ˜¯å¦å­˜åœ¨ï¼š
```bash
docker exec container ls -la /app/frontend/src/components/
```

2. ä½¿ç”¨æ­£ç¡®çš„è·¯å¾„æ ¼å¼ï¼š
```bash
# é”™è¯¯ï¼šç›¸å¯¹è·¯å¾„
docker cp file.tsx container:components/

# æ­£ç¡®ï¼šç»å¯¹è·¯å¾„
docker cp file.tsx container:/app/frontend/src/components/
```

3. æ³¨æ„ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚æ‹¬å·ï¼‰éœ€è¦è½¬ä¹‰ï¼š
```bash
docker cp file.tsx container:/app/\(dashboard\)/sources/
```

---

### é—®é¢˜3ï¼šæ„å»ºæˆåŠŸä½†é¡µé¢ä¸æ›´æ–°

**å¯èƒ½åŸå› **ï¼š
- æµè§ˆå™¨ç¼“å­˜
- å®¹å™¨æœªé‡å¯
- æ„å»ºäº§ç‰©æœªç”Ÿæ•ˆ

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. å¼ºåˆ¶æ¸…é™¤ç¼“å­˜é‡æ–°æ„å»º
docker exec container sh -c "cd /app/frontend && rm -rf .next && npm run build"

# 2. ç¡¬é‡å¯å®¹å™¨
docker compose stop open_notebook
docker compose up -d open_notebook

# 3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼ˆCmd+Shift+R / Ctrl+Shift+Rï¼‰
```

---

### é—®é¢˜4ï¼šTypeScriptç±»å‹é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Type 'X' is not assignable to type 'Y'
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ä¿®æ”¹çš„å­—ç¬¦ä¸²æ˜¯å¦å½±å“äº†ç±»å‹å®šä¹‰
2. ä½¿ç”¨ `@ts-expect-error` ä¸´æ—¶å¿½ç•¥ï¼ˆä»…ç”¨äºå·²çŸ¥é—®é¢˜ï¼‰
3. ä¿®æ­£ç±»å‹å®šä¹‰

```typescript
// ä¸´æ—¶å¿½ç•¥ç±»å‹é”™è¯¯
// @ts-expect-error - Type inference issue with zod schema
control={control}
```

---

## æ€§èƒ½ä¼˜åŒ–æŠ€å·§

### 1. åˆ©ç”¨Next.jså¢é‡æ„å»º

**åŸç†**ï¼šNext.jsåªé‡æ–°ç¼–è¯‘ä¿®æ”¹çš„æ–‡ä»¶

**å®è·µ**ï¼š
- âœ… ä¿®æ”¹å•ä¸ªç»„ä»¶ï¼šæ„å»ºæ—¶é—´ < 15ç§’
- âœ… ä¿®æ”¹å¤šä¸ªç›¸å…³ç»„ä»¶ï¼šæ„å»ºæ—¶é—´ < 30ç§’
- âš ï¸ ä¿®æ”¹å…±äº«ä¾èµ–ï¼šå¯èƒ½è§¦å‘å…¨é‡æ„å»º

### 2. æ‰¹é‡å¤åˆ¶æ–‡ä»¶

**å¯¹æ¯”**ï¼š
```bash
# æ–¹å¼Aï¼šé€ä¸ªå¤åˆ¶ï¼ˆ17æ¬¡docker cpè°ƒç”¨ï¼‰
è€—æ—¶ï¼š~30ç§’

# æ–¹å¼Bï¼šé“¾å¼å¤åˆ¶ï¼ˆ8æ¬¡docker cpè°ƒç”¨ï¼‰
è€—æ—¶ï¼š~15ç§’

# æ–¹å¼Cï¼šç›®å½•å¤åˆ¶ï¼ˆ1æ¬¡docker cpè°ƒç”¨ï¼‰
è€—æ—¶ï¼š~5ç§’
```

**æ¨è**ï¼šæ ¹æ®æ–‡ä»¶æ•°é‡é€‰æ‹©æ–¹å¼

### 3. å¹¶è¡Œæ‰§è¡Œï¼ˆé€‚ç”¨äºå¤šå®¹å™¨ï¼‰

```bash
# å¦‚æœéœ€è¦åŒæ—¶æ›´æ–°å¤šä¸ªæœåŠ¡
docker cp file1 container1:/path &
docker cp file2 container2:/path &
wait

# å¹¶è¡Œæ„å»º
docker exec container1 npm run build &
docker exec container2 npm run build &
wait
```

---

## ç»éªŒæ•™è®­

### âœ… æˆåŠŸç»éªŒ

1. **ä½¿ç”¨Taskå·¥å…·æ‰¹é‡å¤„ç†**
   - èŠ‚çœæ—¶é—´ï¼š45åˆ†é’Ÿå®Œæˆ17ä¸ªæ–‡ä»¶çš„ä¿®æ”¹
   - å‡å°‘é”™è¯¯ï¼šè‡ªåŠ¨åº”ç”¨ç»Ÿä¸€è§„åˆ™
   - å¯è¿½æº¯ï¼šç”Ÿæˆè¯¦ç»†æŠ¥å‘Š

2. **å®¹å™¨å†…çƒ­æ›´æ–°æ›¿ä»£å®Œæ•´é‡å»º**
   - é€Ÿåº¦æå‡ï¼šä»15åˆ†é’Ÿ â†’ 1åˆ†é’Ÿ
   - é¿å…ç½‘ç»œé—®é¢˜
   - é€‚åˆå¿«é€Ÿè¿­ä»£

3. **åˆ¶å®šæ¸…æ™°çš„ä¿®æ”¹è§„åˆ™**
   - ä¸“ä¸šæœ¯è¯­ä¿ç•™è§„åˆ™
   - å“ç‰Œåç§°æ˜ å°„
   - ä¸­è‹±æ–‡æ··æ’è§„èŒƒ

4. **è¯¦ç»†çš„éªŒè¯æ¸…å•**
   - å®¹å™¨çŠ¶æ€æ£€æŸ¥
   - åŠŸèƒ½æµ‹è¯•æ¸…å•
   - æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•

---

### âš ï¸ é¿å…çš„é”™è¯¯

1. **ä¸è¦ç›´æ¥é‡å»ºDockeré•œåƒ**ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
   - æ—¶é—´æˆæœ¬é«˜
   - å¯èƒ½é‡åˆ°ç½‘ç»œé—®é¢˜
   - ä¸é€‚åˆé¢‘ç¹è¿­ä»£

2. **ä¸è¦å¿˜è®°é‡å¯å®¹å™¨**
   - æ„å»ºåå¿…é¡»é‡å¯æ‰èƒ½ç”Ÿæ•ˆ
   - ä½¿ç”¨ `docker compose restart` è€Œé `docker exec restart`

3. **ä¸è¦è·³è¿‡Readæ­¥éª¤**
   - Editå·¥å…·è¦æ±‚å…ˆReadæ–‡ä»¶
   - é¿å…åŸºäºå‡è®¾è¿›è¡Œä¿®æ”¹

4. **ä¸è¦ä¸€æ¬¡æ€§ä¿®æ”¹è¿‡å¤šæ–‡ä»¶**
   - åˆ†æ‰¹ä¿®æ”¹å’Œæµ‹è¯•
   - æ¯æ‰¹ä¿®æ”¹åéªŒè¯åŠŸèƒ½
   - ä¾¿äºå®šä½é—®é¢˜

---

## å¿«é€Ÿå‚è€ƒ

### å®Œæ•´å·¥ä½œæµé€ŸæŸ¥è¡¨

```bash
# 1. ä»£ç ä¿®æ”¹ï¼ˆä½¿ç”¨Taskå·¥å…·æˆ–æ‰‹åŠ¨Editï¼‰

# 2. å¤åˆ¶æ–‡ä»¶åˆ°å®¹å™¨
docker cp file1.tsx chairman_open_notebook:/app/frontend/src/path1/
docker cp file2.tsx chairman_open_notebook:/app/frontend/src/path2/

# 3. å®¹å™¨å†…æ„å»º
docker exec chairman_open_notebook sh -c "cd /app/frontend && npm run build 2>&1 | tail -50"

# 4. é‡å¯å®¹å™¨
docker compose restart open_notebook

# 5. éªŒè¯çŠ¶æ€
docker compose ps open_notebook

# 6. è®¿é—®æµ‹è¯•
# http://localhost:8502
```

### æ—¶é—´é¢„ç®—ï¼ˆ17ä¸ªæ–‡ä»¶ç¤ºä¾‹ï¼‰

| æ­¥éª¤ | æ—¶é—´ |
|------|------|
| ä»£ç ä¿®æ”¹ | 45åˆ†é’Ÿ |
| æ–‡ä»¶å¤åˆ¶ | 1åˆ†é’Ÿ |
| æ„å»º | 11ç§’ |
| é‡å¯ | 5ç§’ |
| éªŒè¯ | 10åˆ†é’Ÿ |
| **æ€»è®¡** | **çº¦60åˆ†é’Ÿ** |

---

## é™„å½•

### A. å¸¸ç”¨å‘½ä»¤æ¸…å•

```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker compose logs -f open_notebook

# è¿›å…¥å®¹å™¨shell
docker exec -it chairman_open_notebook sh

# æŸ¥çœ‹å®¹å™¨å†…æ–‡ä»¶
docker exec chairman_open_notebook ls -la /app/frontend/src/

# æŸ¥çœ‹æ„å»ºäº§ç‰©
docker exec chairman_open_notebook ls -la /app/frontend/.next/

# æ¸…é™¤æ„å»ºç¼“å­˜
docker exec chairman_open_notebook sh -c "cd /app/frontend && rm -rf .next node_modules/.cache"

# å®Œæ•´é‡æ–°å®‰è£…ä¾èµ–
docker exec chairman_open_notebook sh -c "cd /app/frontend && rm -rf node_modules && npm install"
```

### B. å®¹å™¨è·¯å¾„æ˜ å°„

| æœ¬åœ°è·¯å¾„ | å®¹å™¨è·¯å¾„ |
|----------|----------|
| `thirdparty/open-notebook/frontend/src/components/` | `/app/frontend/src/components/` |
| `thirdparty/open-notebook/frontend/src/app/` | `/app/frontend/src/app/` |
| `thirdparty/open-notebook/frontend/src/lib/` | `/app/frontend/src/lib/` |

### C. Next.jsæ„å»ºè¾“å‡ºè¯´æ˜

```
Route (app)                        Size    First Load JS
â”Œ â—‹ /login                        10.7 kB  122 kB
```

**å›¾ä¾‹**ï¼š
- `â—‹` = Staticï¼ˆé™æ€é¢„æ¸²æŸ“ï¼‰
- `Æ’` = Dynamicï¼ˆæœåŠ¡ç«¯åŠ¨æ€æ¸²æŸ“ï¼‰
- `Size` = é¡µé¢ç‰¹å®šä»£ç å¤§å°
- `First Load JS` = é¦–æ¬¡åŠ è½½çš„JavaScriptæ€»å¤§å°

---

**æ–‡æ¡£ç»´æŠ¤è€…**: Claude Code
**æœ€åæ›´æ–°**: 2025-11-25
**ç‰ˆæœ¬**: v2.0
