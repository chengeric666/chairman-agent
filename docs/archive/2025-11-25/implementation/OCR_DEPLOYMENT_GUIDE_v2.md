# Open-Notebook OCRåŠŸèƒ½éƒ¨ç½²æŒ‡å—

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv2.0.0ï¼ˆæŒä¹…åŒ–ç‰ˆæœ¬ï¼‰
**åˆ›å»ºæ—¥æœŸ**ï¼š2025-11-25
**æ›´æ–°æ—¥æœŸ**ï¼š2025-11-25
**éƒ¨ç½²æ–¹æ¡ˆ**ï¼šæ¨¡åž‹æŒä¹…åŒ– + ä¸€é”®å®‰è£…è„šæœ¬

---

## ðŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—æä¾›Open-Notebookå®¹å™¨ä¸­OCRåŠŸèƒ½çš„**æŒä¹…åŒ–éƒ¨ç½²æ–¹æ¡ˆ**ã€‚é€šè¿‡Docker VolumeæŒ‚è½½ï¼Œå®žçŽ°OCRæ¨¡åž‹çš„æ°¸ä¹…ä¿å­˜ï¼Œé¿å…å®¹å™¨é‡å¯åŽé‡å¤ä¸‹è½½500MBæ¨¡åž‹æ–‡ä»¶ã€‚

### ðŸŽ¯ æ–¹æ¡ˆç‰¹ç‚¹

- âœ… **æ¨¡åž‹æŒä¹…åŒ–**ï¼šæ¨¡åž‹æ–‡ä»¶ä¿å­˜åœ¨å®¿ä¸»æœºï¼Œå®¹å™¨é‡å¯åŽæ— éœ€é‡æ–°ä¸‹è½½
- âœ… **ä¸€é”®å®‰è£…**ï¼šæä¾›è‡ªåŠ¨åŒ–è„šæœ¬ `scripts/setup_ocr.sh`
- âœ… **å¿«é€Ÿæ¢å¤**ï¼šå®¹å™¨é‡å¯åŽä»…éœ€1-2åˆ†é’Ÿé‡è£…PythonåŒ…
- âœ… **å®Œæ•´è‡ªåŠ¨åŒ–**ï¼šåŒ…æ‹¬PyPIé•œåƒã€ä¾èµ–å®‰è£…ã€å…¼å®¹æ€§è¡¥ä¸

### âœ… å·²å®Œæˆå·¥ä½œ

1. **DockeræŒä¹…åŒ–é…ç½®** - æ·»åŠ æ¨¡åž‹ç›®å½•volumeæŒ‚è½½
2. **å‰ç«¯ä¸­æ–‡åŒ–** - çƒ­æ›´æ–°æˆåŠŸï¼Œç•Œé¢å·²å®Œå…¨ä¸­æ–‡åŒ–
3. **ä¸€é”®å®‰è£…è„šæœ¬** - å…¨è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
4. **å…¼å®¹æ€§ä¿®å¤** - langchainæ¨¡å—é‡å®šå‘è¡¥ä¸
5. **åŠŸèƒ½éªŒè¯** - OCRå¼•æ“Žåˆå§‹åŒ–æˆåŠŸ

---

## ðŸš€ å¿«é€Ÿéƒ¨ç½²æ­¥éª¤ï¼ˆæŽ¨èï¼‰

### å‰ææ¡ä»¶

ç¡®ä¿docker-compose.ymlåŒ…å«ä»¥ä¸‹é…ç½®ï¼š

```yaml
volumes:
  - ./data/notebook:/app/data
  - ./thirdparty/open-notebook/frontend:/app/frontend
  - ./data/paddleocr_models:/root/.paddleocr  # æ¨¡åž‹æŒä¹…åŒ–ç›®å½•
```

### æ­¥éª¤1ï¼šå¯åŠ¨å®¹å™¨

```bash
cd /Users/batfic887/Documents/project/chairman-agent
docker compose up -d open_notebook
```

### æ­¥éª¤2ï¼šé€‰æ‹©å¹¶è¿è¡Œå®‰è£…è„šæœ¬

æˆ‘ä»¬æä¾›ä¸¤ä¸ªå®‰è£…è„šæœ¬ï¼Œæ ¹æ®éœ€æ±‚é€‰æ‹©ï¼š

#### æ–¹æ¡ˆAï¼šå®Œæ•´çŽ¯å¢ƒé…ç½®ï¼ˆæŽ¨èï¼‰â­

```bash
./scripts/setup_complete.sh
```

**åŒ…å«åŠŸèƒ½**ï¼š
- âœ… OCRçŽ¯å¢ƒå®‰è£…ï¼ˆPythonåŒ… + æ¨¡åž‹ï¼‰
- âœ… å‰ç«¯é‡å»ºï¼ˆåº”ç”¨ä¸­æ–‡åŒ–ä¿®æ”¹ï¼‰
- âœ… å®¹å™¨è‡ªåŠ¨é‡å¯

**é¢„è®¡æ—¶é—´**ï¼š
- é¦–æ¬¡è¿è¡Œï¼š6-12åˆ†é’Ÿï¼ˆå«æ¨¡åž‹ä¸‹è½½ + å‰ç«¯æž„å»ºï¼‰
- åŽç»­è¿è¡Œï¼š3-5åˆ†é’Ÿï¼ˆæ¨¡åž‹å·²ç¼“å­˜ï¼‰

#### æ–¹æ¡ˆBï¼šä»…OCRçŽ¯å¢ƒ

```bash
./scripts/setup_ocr.sh
```

**åŒ…å«åŠŸèƒ½**ï¼š
- âœ… OCRçŽ¯å¢ƒå®‰è£…ï¼ˆPythonåŒ… + æ¨¡åž‹ï¼‰
- âŒ ä¸åŒ…å«å‰ç«¯é‡å»º

**é¢„è®¡æ—¶é—´**ï¼š
- é¦–æ¬¡è¿è¡Œï¼š5-10åˆ†é’Ÿï¼ˆå«æ¨¡åž‹ä¸‹è½½ï¼‰
- åŽç»­è¿è¡Œï¼š1-2åˆ†é’Ÿï¼ˆæ¨¡åž‹å·²ç¼“å­˜ï¼‰

**æ³¨æ„**ï¼šä½¿ç”¨æ–¹æ¡ˆBåŽï¼Œå‰ç«¯ä¸­æ–‡åŒ–å¯èƒ½ä¸ç”Ÿæ•ˆï¼Œéœ€æ‰‹åŠ¨é‡å»ºå‰ç«¯ã€‚

### æ­¥éª¤3ï¼šéªŒè¯å®‰è£…

1. è®¿é—® http://localhost:8502
2. æ£€æŸ¥ç•Œé¢æ˜¯å¦å·²ä¸­æ–‡åŒ–ï¼ˆå¦‚ä½¿ç”¨å®Œæ•´è„šæœ¬ï¼‰
3. ä¸Šä¼ PDFæµ‹è¯•OCRåŠŸèƒ½

---

## ðŸ“ æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤ï¼ˆå¯é€‰ï¼‰

å¦‚æžœä¸ä½¿ç”¨ä¸€é”®è„šæœ¬ï¼Œå¯ä»¥æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

### æ­¥éª¤2ï¼šé…ç½®PyPIé•œåƒï¼ˆåŠ é€Ÿä¸‹è½½ï¼‰

```bash
docker exec chairman_open_notebook sh -c "/app/.venv/bin/pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple"
```

### æ­¥éª¤3ï¼šå®‰è£…OCR PythonåŒ…

```bash
docker exec chairman_open_notebook sh -c "/app/.venv/bin/pip install --no-cache-dir paddlepaddle==3.2.2 paddleocr Pillow shapely pyclipper"
```

**é¢„è®¡æ—¶é—´**ï¼š1-3åˆ†é’Ÿï¼ˆå–å†³äºŽç½‘ç»œé€Ÿåº¦ï¼‰

### æ­¥éª¤4ï¼šå®‰è£…langchainä¾èµ–å¹¶åˆ›å»ºå…¼å®¹æ€§è¡¥ä¸

```bash
docker exec chairman_open_notebook sh -c "
# å®‰è£…langchain
/app/.venv/bin/pip install langchain langchain-community langchain-text-splitters

# åˆ›å»ºdocstoreå…¼å®¹æ€§shim
cat > /app/.venv/lib/python3.12/site-packages/langchain/docstore.py << 'SHIM1'
'''å…¼å®¹æ€§shimï¼šé‡å®šå‘åˆ°langchain_community.docstore'''
from langchain_community import docstore
import sys
sys.modules['langchain.docstore'] = docstore
__all__ = dir(docstore)
SHIM1

# åˆ›å»ºtext_splitterå…¼å®¹æ€§shim
cat > /app/.venv/lib/python3.12/site-packages/langchain/text_splitter.py << 'SHIM2'
'''å…¼å®¹æ€§shimï¼šé‡å®šå‘åˆ°langchain_text_splitters'''
from langchain_text_splitters import *
SHIM2

echo 'âœ… å…¼å®¹æ€§è¡¥ä¸åˆ›å»ºæˆåŠŸ'
"
```

### æ­¥éª¤5ï¼šéªŒè¯å®‰è£…

```bash
docker exec chairman_open_notebook python3 -c "
from paddleocr import PaddleOCR
print('âœ… PaddleOCRå¯¼å…¥æˆåŠŸ')
ocr = PaddleOCR(use_angle_cls=True, lang='ch', show_log=False)
print('âœ… OCRå¼•æ“Žåˆå§‹åŒ–æˆåŠŸ')
print('ðŸŽ‰ OCRåŠŸèƒ½å®Œå…¨å°±ç»ªï¼')
"
```

**æ³¨æ„**ï¼šé¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ä¸‹è½½é¢„è®­ç»ƒæ¨¡åž‹ï¼ˆçº¦500MBï¼‰ï¼Œéœ€è¦ç­‰å¾…3-5åˆ†é’Ÿã€‚

---

## ðŸ“¦ å®‰è£…çš„åŒ…æ¸…å•

| åŒ…å | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| paddlepaddle | 3.2.2 | PaddlePaddleæ·±åº¦å­¦ä¹ æ¡†æž¶ |
| paddleocr | 3.3.2 | OCRè¯†åˆ«å¼•æ“Ž |
| Pillow | æœ€æ–° | å›¾åƒå¤„ç† |
| shapely | æœ€æ–° | å‡ ä½•è®¡ç®— |
| pyclipper | æœ€æ–° | å¤šè¾¹å½¢è£å‰ª |
| langchain | æœ€æ–° | æ–‡æ¡£å¤„ç†æ¡†æž¶ |
| langchain-community | æœ€æ–° | langchainç¤¾åŒºæ‰©å±• |
| langchain-text-splitters | æœ€æ–° | æ–‡æœ¬åˆ†å‰²å·¥å…· |

**æ€»ä¸‹è½½å¤§å°**ï¼šçº¦800MB

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

### 1. **éžæŒä¹…åŒ–**
- è¿è¡Œæ—¶å®‰è£…çš„åŒ…**ä¸æŒä¹…åŒ–**åˆ°é•œåƒå±‚
- å®¹å™¨é‡å¯åŽï¼Œæ‰€æœ‰å®‰è£…çš„åŒ…ä¼šä¸¢å¤±
- éœ€è¦é‡æ–°æ‰§è¡Œæ­¥éª¤2-5

### 2. **å…¼å®¹æ€§è¡¥ä¸å¿…éœ€**
- PaddleOCR 3.3.2ä¾èµ–æ—§ç‰ˆlangchain API
- å¿…é¡»åˆ›å»ºå…¼å®¹æ€§shimsæ‰èƒ½æ­£å¸¸å·¥ä½œ
- è¡¥ä¸ä½ç½®ï¼š`/app/.venv/lib/python3.12/site-packages/langchain/`

### 3. **ç³»ç»ŸåŒ…ç¼ºå¤±**
- å®˜æ–¹é•œåƒå¯èƒ½ç¼ºå°‘OpenCVæ‰€éœ€çš„ç³»ç»Ÿåº“
- å¦‚é‡`libGL.so.1`ç­‰é”™è¯¯ï¼Œéœ€è¦å®‰è£…ç³»ç»Ÿä¾èµ–ï¼š
  ```bash
  docker exec chairman_open_notebook sh -c "apt-get update && apt-get install -y libgl1-mesa-glx libglib2.0-0"
  ```

### 4. **ç½‘ç»œè¦æ±‚**
- é¦–æ¬¡åˆå§‹åŒ–éœ€è¦ä¸‹è½½é¢„è®­ç»ƒæ¨¡åž‹
- éœ€è¦ç¨³å®šçš„ç½‘ç»œè¿žæŽ¥
- å»ºè®®ä½¿ç”¨æ¸…åŽPyPIé•œåƒåŠ é€Ÿ

---

## ðŸ”„ å‰ç«¯ä¸­æ–‡åŒ–éªŒè¯

### å·²åº”ç”¨çš„ä¿®æ”¹

```yaml
# docker-compose.yml (line 136)
volumes:
  - ./data/notebook:/app/data
  - ./thirdparty/open-notebook/frontend:/app/frontend  # çƒ­æ›´æ–°æŒ‚è½½
```

### éªŒè¯æ­¥éª¤

1. è®¿é—® http://localhost:8502
2. æ£€æŸ¥ç•Œé¢æ–‡å­—æ˜¯å¦ä¸ºä¸­æ–‡
3. å¦‚æžœä»ä¸ºè‹±æ–‡ï¼Œæ‰§è¡Œå‰ç«¯é‡å»ºï¼š
   ```bash
   docker exec chairman_open_notebook sh -c "cd /app/frontend && rm -rf .next && npm run build"
   docker compose restart open_notebook
   ```

---

## ðŸ“ æœ¬æ¬¡ä¼šè¯æˆæžœæ€»ç»“

### âœ… å®Œæˆçš„ä»»åŠ¡

1. **Dockerçƒ­æ›´æ–°é…ç½®** - å·æŒ‚è½½æœ¬åœ°å‰ç«¯ä»£ç 
2. **å‰ç«¯ä¸­æ–‡åŒ–** - ä¿®å¤layout.tsxå­—ä½“é—®é¢˜ï¼ŒæˆåŠŸæž„å»º
3. **OCRçŽ¯å¢ƒéƒ¨ç½²** - å®Œæ•´çš„è¿è¡Œæ—¶å®‰è£…æµç¨‹
4. **å…¼å®¹æ€§ä¿®å¤** - langchainç‰ˆæœ¬å…¼å®¹é—®é¢˜è§£å†³
5. **æ–‡æ¡£æ›´æ–°** - BEST_PRACTICES v2.0ã€æœ¬éƒ¨ç½²æŒ‡å—

### ðŸ“Š æŠ€æœ¯æ ˆç‰ˆæœ¬

- **PaddlePaddle**: 3.2.2 (æœ€æ–°ç¨³å®šç‰ˆ)
- **PaddleOCR**: 3.3.2
- **Next.js**: 15.4.7
- **Python**: 3.12
- **Docker**: Compose v2

### â±ï¸ éƒ¨ç½²æ—¶é—´ä¼°ç®—

- åˆæ¬¡éƒ¨ç½²ï¼š~10åˆ†é’Ÿï¼ˆå«æ¨¡åž‹ä¸‹è½½ï¼‰
- é‡æ–°éƒ¨ç½²ï¼š~3åˆ†é’Ÿï¼ˆåŒ…å·²ç¼“å­˜ï¼‰

---

## ðŸ”® åŽç»­å»ºè®®

### é˜¶æ®µ2ï¼šæŒä¹…åŒ–éƒ¨ç½²

ä¸ºäº†é¿å…æ¯æ¬¡é‡å¯å®¹å™¨éƒ½éœ€è¦é‡æ–°å®‰è£…ï¼Œå»ºè®®æž„å»ºæ‰©å±•é•œåƒï¼š

1. **ä½¿ç”¨çŽ°æœ‰Dockerfile** - `thirdparty/open-notebook/Dockerfile.ocr`
2. **ç½‘ç»œé—®é¢˜è§£å†³æ–¹æ¡ˆ**ï¼š
   - æ–¹æ¡ˆAï¼šåœ¨ç½‘ç»œè‰¯å¥½çš„çŽ¯å¢ƒæž„å»º
   - æ–¹æ¡ˆBï¼šä½¿ç”¨entrypointè„šæœ¬è‡ªåŠ¨å®‰è£…
   - æ–¹æ¡ˆCï¼šé¢„å…ˆä¸‹è½½wheelæ–‡ä»¶æ‰‹åŠ¨å®‰è£…

3. **æž„å»ºå‘½ä»¤**ï¼ˆå½“ç½‘ç»œå¯ç”¨æ—¶ï¼‰ï¼š
   ```bash
   cd /Users/batfic887/Documents/project/chairman-agent
   docker compose build open_notebook
   ```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ¨¡åž‹ç¼“å­˜**ï¼šé¦–æ¬¡ä¸‹è½½åŽï¼Œæ¨¡åž‹ä¿å­˜åœ¨ `~/.paddleocr/`
2. **æŒä¹…åŒ–å·**ï¼šå»ºè®®æŒ‚è½½ `.paddleocr` ç›®å½•é¿å…é‡å¤ä¸‹è½½
3. **GPUåŠ é€Ÿ**ï¼šå¦‚æœ‰GPUï¼Œå¯å®‰è£… `paddlepaddle-gpu` ç‰ˆæœ¬

---

## ðŸ› å¸¸è§é—®é¢˜æŽ’æŸ¥

### Q1: å¯¼å…¥PaddleOCRå¤±è´¥
**åŽŸå› **ï¼šå®¹å™¨é‡å¯åŽåŒ…ä¸¢å¤±
**è§£å†³**ï¼šé‡æ–°æ‰§è¡Œæ­¥éª¤2-4

### Q2: langchainæ¨¡å—é”™è¯¯
**åŽŸå› **ï¼šå…¼å®¹æ€§shimsæœªåˆ›å»º
**è§£å†³**ï¼šæ‰§è¡Œæ­¥éª¤4åˆ›å»ºè¡¥ä¸

### Q3: å‰ç«¯ä»ä¸ºè‹±æ–‡
**åŽŸå› **ï¼š.nextç¼“å­˜æˆ–æœªé‡å¯
**è§£å†³**ï¼šåˆ é™¤.nextå¹¶é‡å»ºå‰ç«¯

### Q4: libGL.so.1é”™è¯¯
**åŽŸå› **ï¼šç³»ç»Ÿåº“ç¼ºå¤±
**è§£å†³**ï¼šå®‰è£…OpenCVä¾èµ–åº“

---

## ðŸ“ž æŠ€æœ¯æ”¯æŒ

- **æ–‡æ¡£ä½ç½®**ï¼š`/docs/OCR_QUICK_DEPLOY_GUIDE.md`
- **ç›¸å…³æ–‡æ¡£**ï¼š
  - `DOCKER_DEPLOYMENT_STRATEGY_ANALYSIS.md`
  - `FRONTEND_DOCKER_DEPLOYMENT_BEST_PRACTICES_v2.0.md`
  - `thirdparty/open-notebook/Dockerfile.ocr`

---

**æœ€åŽæ›´æ–°**ï¼š2025-11-25
**éªŒè¯çŽ¯å¢ƒ**ï¼šApple Silicon (ARM64), Docker Desktop
**çŠ¶æ€**ï¼šâœ… å·²éªŒè¯å¯ç”¨
