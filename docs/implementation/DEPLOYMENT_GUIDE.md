# Chairman Agent éƒ¨ç½²æŒ‡å—

**æ–‡æ¡£ç‰ˆæœ¬**: 2.0 (SSOT)
**æœ€åæ›´æ–°**: 2025-11-25
**çŠ¶æ€**: âœ… å·²éªŒè¯

---

## æ¦‚è¿°

æœ¬æ–‡æ¡£æ˜¯Chairman Agenté¡¹ç›®çš„**å•ä¸€äº‹å®æ¥æºï¼ˆSSOTï¼‰**éƒ¨ç½²æŒ‡å—ï¼Œæ¶µç›–ï¼š
- åŸºç¡€æœåŠ¡éƒ¨ç½²
- Open-Notebookéƒ¨ç½²
- OCRåŠŸèƒ½éƒ¨ç½²
- å‰ç«¯ä»£ç æ›´æ–°

---

## 1. éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æµè§ˆå™¨/å®¢æˆ·ç«¯                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
   â”‚UIç•Œé¢   â”‚      â”‚çŸ¥è¯†åº“UI    â”‚
   â”‚(8001)   â”‚      â”‚(8502)      â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚                 â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
   â”‚  Chairman APIç½‘å…³ (8001)    â”‚
   â”‚  + Open-Notebook API (5055) â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜
        â”‚          â”‚          â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
   â”‚OpenCanvas    â”‚OpenDR    â”‚SurrealDBâ”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æœåŠ¡ç«¯å£æ±‡æ€»

| æœåŠ¡ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| **Open-Notebook UI** | http://localhost:8502 | çŸ¥è¯†åº“Webç•Œé¢ |
| **Open-Notebook API** | http://localhost:5055/api | çŸ¥è¯†åº“REST API |
| **Chairman APIç½‘å…³** | http://localhost:8001 | Chairmanç»Ÿä¸€APIå…¥å£ |
| **SurrealDB HTTP** | http://localhost:8000 | æ•°æ®åº“HTTPæ¥å£ |
| **SurrealDB WebSocket** | ws://localhost:8000/rpc | æ•°æ®åº“WebSocketè¿æ¥ |
| **Milvus** | http://localhost:19530 | å‘é‡æ•°æ®åº“ |
| **Redis** | redis://localhost:6379 | ç¼“å­˜å­˜å‚¨ |

---

## 2. ç¯å¢ƒè¦æ±‚

- **Docker**: >= 20.10
- **Docker Compose**: >= 2.0
- **å†…å­˜**: æœ€å°‘ 8GBï¼ˆæ¨è 16GBï¼‰
- **ç£ç›˜**: æœ€å°‘ 20GB

---

## 3. åŸºç¡€æœåŠ¡éƒ¨ç½²

### 3.1 åˆ›å»ºç¯å¢ƒæ–‡ä»¶

```bash
cp .env.example .env
# ç¼–è¾‘ .envï¼Œé…ç½® OPENROUTER_API_KEY
```

### 3.2 åˆ›å»ºæ•°æ®ç›®å½•

```bash
mkdir -p data/{surreal,notebook,redis,etcd,minio,milvus,api}
chmod 755 data/*
```

### 3.3 å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker compose up -d

# éªŒè¯æœåŠ¡çŠ¶æ€
docker compose ps
```

### 3.4 éªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥Open-Notebook API
curl -s http://localhost:5055/api/config

# æ£€æŸ¥SurrealDB
curl -s http://localhost:8000/health
```

---

## 4. OCRåŠŸèƒ½éƒ¨ç½²

### 4.1 æ ¸å¿ƒå‘ç°ï¼ˆå·²éªŒè¯ï¼‰

| é¡¹ç›® | ç»“æœ | è¯´æ˜ |
|------|------|------|
| å®˜æ–¹é•œåƒOCRä¾èµ– | âœ… å·²åŒ…å« | PaddleOCRã€libglç­‰å·²å®‰è£… |
| å‰ç«¯Volume Mount | âœ… æœ‰æ•ˆ | æœ¬åœ°ä¿®æ”¹è‡ªåŠ¨åŒæ­¥ |
| åç«¯Volume Mount | âŒ æœªé…ç½® | éœ€ä½¿ç”¨docker cp |
| æ‰©å±•é•œåƒéœ€æ±‚ | âŒ ä¸éœ€è¦ | å®˜æ–¹é•œåƒè¶³å¤Ÿ |

### 4.2 éƒ¨ç½²æ–¹æ³•ï¼šdocker cpï¼ˆæ¨èï¼‰

```bash
# Step 1: å¤åˆ¶OCRå·¥å…·æ–‡ä»¶
docker cp thirdparty/open-notebook/open_notebook/utils/pdf_ocr_utils.py \
  chairman_open_notebook:/app/open_notebook/utils/pdf_ocr_utils.py

# Step 2: å¤åˆ¶ä¿®æ”¹è¿‡çš„source.py
docker cp thirdparty/open-notebook/open_notebook/graphs/source.py \
  chairman_open_notebook:/app/open_notebook/graphs/source.py

# Step 3: é‡å¯å®¹å™¨
docker compose restart open_notebook

# Step 4: éªŒè¯
docker exec chairman_open_notebook ls -la /app/open_notebook/utils/pdf_ocr_utils.py
```

### 4.3 éªŒè¯OCRåŠŸèƒ½

```bash
# éªŒè¯æ¨¡å—å¯¼å…¥
docker exec chairman_open_notebook /app/.venv/bin/python3 -c \
  "from open_notebook.utils.pdf_ocr_utils import process_pdf_with_ocr_fallback; print('OK')"

# éªŒè¯PaddleOCR
docker exec chairman_open_notebook /app/.venv/bin/python3 -c \
  "from paddleocr import PaddleOCR; print('PaddleOCR OK')"
```

### 4.4 è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬

ä½¿ç”¨ `scripts/deploy_ocr.sh`ï¼š

```bash
chmod +x scripts/deploy_ocr.sh
./scripts/deploy_ocr.sh
```

### 4.5 OCRä¾èµ–æ¸…å•

**ç³»ç»Ÿä¾èµ–** (å®˜æ–¹é•œåƒå·²åŒ…å«):
- libgl1-mesa-glx (OpenCVæ ¸å¿ƒä¾èµ–)
- libglib2.0-0 (GLibåº“)

**Pythonä¾èµ–** (å®˜æ–¹é•œåƒå·²åŒ…å«):
| åŒ…å | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| paddlepaddle | 2.6.0+ | æ·±åº¦å­¦ä¹ æ¡†æ¶ |
| paddleocr | 2.8.0+ | OCRè¯†åˆ«å¼•æ“ |
| PyMuPDF | 1.24.0+ | PDFè§£æ |
| Pillow | 10.0.0+ | å›¾åƒå¤„ç† |

**OCRæ¨¡å‹** (è‡ªåŠ¨ç¼“å­˜äº `/root/.paddlex/`):
- æ£€æµ‹æ¨¡å‹: ~70MB
- è¯†åˆ«æ¨¡å‹: ~100MB
- æ–¹å‘åˆ†ç±»æ¨¡å‹: ~40MB

---

## 5. éƒ¨ç½²ç­–ç•¥å¯¹æ¯”

### 5.1 å››ç§éƒ¨ç½²æ–¹æ¡ˆ

| æ–¹æ¡ˆ | é€‚ç”¨åœºæ™¯ | é€Ÿåº¦ | æŒä¹…æ€§ | æ¨èåº¦ |
|------|----------|------|--------|--------|
| **A. çƒ­æ›´æ–°** | çº¯ä»£ç ä¿®æ”¹ï¼ˆå‰ç«¯/åç«¯é€»è¾‘ï¼‰ | âš¡âš¡âš¡âš¡âš¡ <1åˆ†é’Ÿ | ä¸­ | â­â­â­â­â­ |
| **B. è¿è¡Œæ—¶å®‰è£…** | å¿«é€ŸéªŒè¯æ–°ä¾èµ– | âš¡âš¡âš¡âš¡ 10-15åˆ†é’Ÿ | ä½ | â­â­â­ |
| **C. æ‰©å±•é•œåƒ** | ç”Ÿäº§ç¯å¢ƒã€ä¾èµ–å˜æ›´ | âš¡âš¡âš¡ 10-15åˆ†é’Ÿ | é«˜ | â­â­â­â­â­ |
| **D. ç¦»çº¿ä¾èµ–åŒ…** | å®Œå…¨ç¦»çº¿ç¯å¢ƒ | âš¡âš¡ 30+åˆ†é’Ÿ | ä½ | â­ |

### 5.2 å†³ç­–æµç¨‹

```
éœ€è¦ä¿®æ”¹ä»€ä¹ˆï¼Ÿ
â”œâ”€ å‰ç«¯ä»£ç /æ ·å¼/æ–‡æ¡ˆ â†’ æ–¹æ¡ˆAï¼ˆçƒ­æ›´æ–°ï¼‰
â”œâ”€ åç«¯Pythonä¸šåŠ¡é€»è¾‘ â†’ æ–¹æ¡ˆAï¼ˆçƒ­æ›´æ–°ï¼‰
â”œâ”€ éœ€è¦æ–°çš„PythonåŒ… â†’ æ–¹æ¡ˆCï¼ˆæ‰©å±•é•œåƒï¼‰
â”œâ”€ éœ€è¦æ–°çš„ç³»ç»ŸåŒ… â†’ æ–¹æ¡ˆCï¼ˆæ‰©å±•é•œåƒï¼‰
â””â”€ å¿«é€Ÿä¸€æ¬¡æ€§éªŒè¯ â†’ æ–¹æ¡ˆBï¼ˆè¿è¡Œæ—¶å®‰è£…ï¼‰
```

### 5.3 åˆ†å±‚æ€ç»´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—ï¸ åŸºç¡€è®¾æ–½å±‚ï¼ˆå¶å°”å˜æ›´ï¼‰                          â”‚
â”‚  â”œâ”€â”€ ç³»ç»Ÿä¾èµ–å˜æ›´          â†’ æ–¹æ¡ˆC: æ‰©å±•é•œåƒ        â”‚
â”‚  â””â”€â”€ PythonåŒ…æ›´æ–°          â†’ æ–¹æ¡ˆC: æ‰©å±•é•œåƒ        â”‚
â”‚                              â†“                      â”‚
â”‚                       æä¾›åŸºç¡€ç¯å¢ƒ                   â”‚
â”‚                              â†“                      â”‚
â”‚  âš¡ å¼€å‘è¿­ä»£å±‚ï¼ˆé¢‘ç¹å˜æ›´ï¼‰                          â”‚
â”‚  â”œâ”€â”€ å‰ç«¯UIä¿®æ”¹            â†’ æ–¹æ¡ˆA: çƒ­æ›´æ–°          â”‚
â”‚  â”œâ”€â”€ åç«¯ä¸šåŠ¡é€»è¾‘          â†’ æ–¹æ¡ˆA: çƒ­æ›´æ–°          â”‚
â”‚  â””â”€â”€ é…ç½®æ–‡ä»¶ä¿®æ”¹          â†’ æ–¹æ¡ˆA: çƒ­æ›´æ–°          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç»“è®º**: 99%çš„æ—¥å¸¸å¼€å‘ä½¿ç”¨çƒ­æ›´æ–°ï¼Œä»…ä¾èµ–å˜æ›´æ—¶é‡å»ºé•œåƒã€‚

---

## 6. å‰ç«¯ä»£ç æ›´æ–°

### 6.1 æ–¹æ¡ˆé€‰æ‹©

| æ–¹æ¡ˆ | é€‚ç”¨åœºæ™¯ | æ—¶é—´ |
|------|----------|------|
| Volume Mount (å·²é…ç½®) | å‰ç«¯ä»£ç ä¿®æ”¹ | å³æ—¶åŒæ­¥ |
| docker cp + build | éœ€è¦é‡æ–°æ„å»º | ~1åˆ†é’Ÿ |
| é‡å»ºé•œåƒ | ä¾èµ–å˜æ›´ | 5-15åˆ†é’Ÿ |

### 6.2 çƒ­æ›´æ–°æµç¨‹ï¼ˆæ¨èï¼‰

ç”±äºå‰ç«¯å·²é…ç½®Volume Mountï¼Œæœ¬åœ°ä¿®æ”¹ä¼šè‡ªåŠ¨åŒæ­¥åˆ°å®¹å™¨ï¼š

```bash
# 1. ä¿®æ”¹æœ¬åœ°å‰ç«¯ä»£ç 
# thirdparty/open-notebook/frontend/src/...

# 2. å®¹å™¨å†…æ„å»º
docker exec chairman_open_notebook sh -c "cd /app/frontend && npm run build"

# 3. é‡å¯å®¹å™¨
docker compose restart open_notebook

# 4. éªŒè¯
# è®¿é—® http://localhost:8502
```

### 6.3 éªŒè¯Volume Mount

```bash
# åˆ›å»ºæµ‹è¯•æ–‡ä»¶
echo "TEST_$(date +%s)" > thirdparty/open-notebook/frontend/TEST.txt

# æ£€æŸ¥å®¹å™¨å†…æ˜¯å¦åŒæ­¥
docker exec chairman_open_notebook cat /app/frontend/TEST.txt

# æ¸…ç†
rm thirdparty/open-notebook/frontend/TEST.txt
```

---

## 7. æœåŠ¡ç®¡ç†

### 7.1 å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker compose ps

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f open_notebook

# é‡å¯æœåŠ¡
docker compose restart open_notebook

# è¿›å…¥å®¹å™¨
docker exec -it chairman_open_notebook sh
```

### 7.2 SupervisordæœåŠ¡

å®¹å™¨å†…ä½¿ç”¨supervisordç®¡ç†ä»¥ä¸‹æœåŠ¡ï¼š
- `api` - åç«¯APIæœåŠ¡
- `worker` - åå°ä»»åŠ¡å¤„ç†
- `frontend` - Next.jså‰ç«¯
- `surrealdb` - å†…åµŒæ•°æ®åº“ï¼ˆå¯é€‰ï¼‰

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker exec chairman_open_notebook supervisorctl status

# é‡å¯å•ä¸ªæœåŠ¡
docker exec chairman_open_notebook supervisorctl restart api
```

---

## 8. å¸¸è§é—®é¢˜

### Q1: å®¹å™¨é‡å»ºåOCRå¤±æ•ˆ

**è§£å†³**: é‡æ–°æ‰§è¡Œéƒ¨ç½²è„šæœ¬
```bash
./scripts/deploy_ocr.sh
```

### Q2: å‰ç«¯ä¿®æ”¹ä¸ç”Ÿæ•ˆ

**æ£€æŸ¥æ­¥éª¤**:
1. ç¡®è®¤Volume Mountæœ‰æ•ˆ
2. æ‰§è¡Œ `npm run build`
3. é‡å¯å®¹å™¨
4. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

### Q3: OCRå¤„ç†å¾ˆæ…¢

**ä¼˜åŒ–å»ºè®®**:
- å½“å‰é…ç½®: DPI=72ï¼ˆå·²ä¼˜åŒ–ï¼‰
- é¢„æœŸé€Ÿåº¦: ~5ç§’/é¡µ
- å¦‚éœ€æ›´å¿«ï¼Œå¯é™ä½DPIåˆ°60

### Q4: SurrealDBè¿æ¥å¤±è´¥

```bash
docker logs chairman_surreal
docker compose restart surreal
```

---

## 9. å‚è€ƒèµ„æº

| æ–‡æ¡£ | è·¯å¾„ |
|------|------|
| é¡¹ç›®æ¦‚è¿° | `/CLAUDE.md` |
| MVPè§„åˆ’ | `/docs/planning/MVP-IMPLEMENTATION-PLAN.md` |
| è¯¦ç»†è®¾è®¡ | `/docs/planning/INTEGRATION_PLAN_DETAILED.md` |
| é—®é¢˜æ’æŸ¥ | `/docs/implementation/TROUBLESHOOTING.md` |
| æºç åˆ†æ | `/docs/reference/DEEP_ANALYSIS_SUMMARY.md` |

---

**æ–‡æ¡£ç»´æŠ¤è€…**: Claude Code
**éªŒè¯çŠ¶æ€**: âœ… å·²é€šè¿‡å®é™…æµ‹è¯•éªŒè¯
